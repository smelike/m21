设备测量状态类


继电器读取 DI1 和 DI2，判断货物是否在经过。


DI1 是入口光电；DI2 是出口光电


DI1 和 DI2 之间，有 高度光幕、长宽光幕、称重传感、触发扫码；


状态说明：
 进入光耦1、离开光耦1；
 进入光幕1、离开光幕1；
 进入称重测量；
 进入光幕2、离开光幕2；
 
 进入光耦2、离开光耦2；
 

场景说明：

进入 DI1，且离开后；在还没有经过 和离开DI2，DI1 的状态就还是 1.

即：入口滚筒的运动控制，要根据 [称重状态weighing_status 和光耦2状态 di2_status]，做判断；
只两者中的之一为真，都必须阻止下一件货物的进入；

所谓下一件货物，即在 [称重状态weighing_status 或 光耦2状态 di2_status] 为真时，di1 收到了遮挡信号；

[1, 0 ,0 ] -> ok

[1, 1, 0] -> not ok
[0, 1, 0] -> not ok
[0, 0, 1] -> not ok

只要 di1 从 0 - 1 -0 了，那么 weighing 就是要为真了，称重获得数据后；那就是 di2 为真了；

di2 是真时， di1 从 0-1 了，那么电机要刹车或点动或停止；
weighing 是真时， di1 从 0 -1 了，就是要停止电机了；




1、使用继电器的指令，读取第一路开关量的变化，确认是否货物通过。

发送指令码：FE 02 00 00 00 04 6D C6 
(地址 指令 起始地址 查询数量 CRC16[校验和，低字节在前])
返回码： FE 02 01 00 91 9C
(地址 指令 字节数 状态 CRC16)

状态数据 00 转换成 2 进制是 0000 0000，代表通断全部断开。高位在前，1表示通道吸合，0 表示断开。


返回码中的第4字节代表状态信息，转换二进制，后四位代表的四个通道的输入状态，1代表吸合，0 代表断开。

1.1 DI1 有输入时，发送 FE 02 00 00 00 04 6D C6，返回 FE 02 01 01 50 5C，01 二进制 0000 0001;
1.2 DI2 有输入时，发送 FE 02 00 00 00 04 6D C6，返回 FE 02 01 03 D1 9D, 03 二进制 0000 0011;

2、场景：在允许测量尺寸范围内的货物，会以动力滚筒运行的线速度，而流过光电开关 Di1，从而产生一个开关的状态变化。

不同长度的货物，货物摆放的水平和倾斜度，都会产生不同的状态。


延迟：光电的响应时间(dt1)，再到继电器的串口读取到数据的时间(dt2)

货物离开后，光电的响应切换，反馈到继电器的串口数据读取，这里的时间长度是多少秒？


3、跟箱：两个货物在多少的时间间隔里，才能被继电器读取出来；


4、创建一个类，实时读取 Di1 和 Di2 的状态；


继电器的波特率是 9600
地址是 1
默认通讯格式：9600,n,8,1



读取 DI 输入

一个 DI 输入时：
TX: FE 02 00 00 00 04 6D C6 
RX: FE 02 01 01 50 5C(只有一个 DI 输入的响应)[01 -> 0000 0001, 代表通道 1 吸合]

两个 DI 输入信号时：
TX: FE 02 00 00 00 04 6D C6 
RX: FE 02 01 03 D1 9D  (通道1和2 吸合)[03 -> 0000 0011, 代表通道 1 和2 吸合]


5、只有货物离开了 DI2，才允许下一个货箱进入。

 

6、记录 Di1 和 Di2 状态改变的开始时间和结束时间，计算变化的时间长度；